{"version":3,"names":[],"mappings":"","sources":["main.js"],"sourcesContent":["(function(){\n\t\"use strict\";\n\n\t// Utilities\n\tfunction trim(text){\n\t\treturn String(text).replace(/^\\s*(.*?)\\s*$/m, '$1')\n\t}\n\tfunction oneNode(node){\n\t\tif(node instanceof NodeList || node instanceof HTMLCollection){\n\t\t\t// Use first element in list\n\t\t\tnode\t= ((node.length > 0) ? node[0] : null);\n\t\t}\n\n\t\treturn node;\n\t}\n\tfunction getText(node, trimText){\n\t\tnode\t= oneNode(node);\n\n\t\tvar content\t= (node ? (node.innerText || node.textContent) : null);\n\t\tif(content == null){\n\t\t\treturn null;\n\t\t}\n\n\t\tif(trimText || trimText === undefined){\n\t\t\tcontent\t= trim(content);\n\t\t}\n\t\treturn content;\n\t}\n\tfunction setText(node, text){\n\t\tnode\t= oneNode(node);\n\t\tif(!node){\n\t\t\treturn;\n\t\t}\n\n\t\tif('textContent' in node){\n\t\t\tnode.textContent\t= text;\n\t\t} else {\n\t\t\tnode.innerText\t\t= text;\n\t\t}\n\t}\n\tfunction find(parent, steps){\n\t\tvar level\t= oneNode(parent);\n\t\tfor(var i = 0; i < steps.length && level != null; i++){\n\t\t\tvar step\t= steps[i];\n\t\t\tparent\t= oneNode(level);\n\t\t\tlevel\t= null;\n\t\t\tswitch(typeof step){\n\t\t\t\tcase 'number':\n\t\t\t\t\tif(parent && parent.childNodes && parent.childNodes.length >= step){\n\t\t\t\t\t\tlevel\t= parent.childNodes[step];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'string':\n\t\t\t\t\tif(step.substr(0, 1) === '.'){\n\t\t\t\t\t\tlevel\t= parent.getElementsByClassName(step.substr(1));\n\t\t\t\t\t\tif(!level.length){\n\t\t\t\t\t\t\tlevel\t= null;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstep\t= step.toUpperCase();\n\t\t\t\t\t\tfor(var j = 0; j < parent.childNodes.length; j++){\n\t\t\t\t\t\t\tvar childNode\t= parent.childNodes[j];\n\t\t\t\t\t\t\tif(childNode.tagName != null && childNode.tagName === step){\n\t\t\t\t\t\t\t\tlevel\t= childNode;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error('Unknown step \"'+step+'\"');\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn level;\n\t}\n\tfunction findOne(){\n\t\treturn oneNode(find.apply(this, arguments));\n\t}\n\tvar __classRegExpPatterns\t= {};\n\tfunction classRegExp(className){\n\t\tif(!(className instanceof RegExp)){\n\t\t\tif(!__classRegExpPatterns[className]){\n\t\t\t\t// Cache instance\n\t\t\t\t__classRegExpPatterns[className]\t= new RegExp('(^|\\\\s)'+className+'(\\\\s|$)', 'm');\n\t\t\t}\n\t\t\tclassName\t= __classRegExpPatterns[className];\n\t\t}\n\t\treturn className;\n\t}\n\tfunction elementHasClass(element, className){\n\t\tvar pattern\t= classRegExp(className);\n\t\treturn !!element.className.match(pattern)\n\t}\n\tfunction toggleClass(element, className, state){\n\t\tvar hasClass\t= elementHasClass(element, className);\n\n\t\tif(state){\n\t\t\t// Add class\n\t\t\tif(!hasClass){\n\t\t\t\telement.className\t+= ' '+className;\n\t\t\t}\n\t\t} else {\n\t\t\t// Remove class\n\t\t\tif(hasClass){\n\t\t\t\tvar pattern\t= classRegExp(className);\n\t\t\t\telement.className\t= element.className.replace(pattern, '$1');\n\t\t\t}\n\t\t}\n\t}\n\tfunction removeNode(node){\n\t\treturn node.parentNode.removeChild(node);\n\t}\n\tfunction loadTemplate(template, singleNode){\n\t\tvar generator\t= document.createElement('div');\n\t\tgenerator.innerHTML\t= trim(template);\n\n\t\tvar result\t= generator;\n\t\tif(singleNode || singleNode === undefined){\n\t\t\tresult\t= oneNode(result);\n\t\t}\n\t\treturn result;\n\t}\n\tfunction insertBefore(element, target){\n\t\treturn target.parentNode.insertBefore(element, target);\n\t}\n\tvar transitionEndEvent;\n\tfunction onTransitionEnd(element, handler){\n\t\tif(!element){\n\t\t\treturn;\n\t\t}\n\n\t\t// Determine supported event\n\t\tif(transitionEndEvent === undefined){\n\t\t\ttransitionEndEvent\t= null;\t// Prevent repeat testing for unsupported browsers (undefined vs null)\n\t\t\tvar transitions\t= {\n\t\t\t\t'transition':       'transitionend',\n\t\t\t\t'OTransition':      'oTransitionEnd',\n\t\t\t\t'MozTransition':    'transitionend',\n\t\t\t\t'WebkitTransition': 'webkitTransitionEnd'\n\t\t\t};\n\t\t\tfor(var t in transitions){ if(!transitions.hasOwnProperty(t)){ continue; }\n\t\t\t\tif(element.style[t] !== undefined){\n\t\t\t\t\ttransitionEndEvent\t= transitions[t];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(transitionEndEvent){\n\t\t\telement.addEventListener(transitionEndEvent, handler);\n\t\t} else {\n\t\t\t// No support - trigger immediately\n\t\t\twindow.setTimeout(function(){\n\t\t\t\thandler.call(element);\n\t\t\t}, 0);\n\t\t}\n\n\t\twindow.setTimeout(function(){\n\t\t\ttoggleClass(element, '__active', false);\n\t\t}, 1500);\n\t}\n\n\tvar moviesContainer\t= document.getElementById('main'),\n\t\tmovieElements\t= document.getElementsByClassName('movie'),\n\t\tactiveFeedback;\n\n\tfunction showFeedback(type){\n\t\tclearFeedback();\n\n\t\tvar template\t= document.getElementById('template-'+type),\n\t\t\tfeedback\t= loadTemplate(template.innerHTML);\n\n\t\tvar resetButton\t= findOne(feedback, ['.search-feedback__reset']);\n\t\tif(resetButton){\n\t\t\tresetButton.addEventListener('click', function(){\n\t\t\t\tresetFilters();\n\t\t\t});\n\t\t}\n\n\t\tactiveFeedback\t= feedback;\n\t\tmoviesContainer.appendChild(activeFeedback);\n\t}\n\tfunction clearFeedback(){\n\t\tif(!activeFeedback){\n\t\t\treturn;\n\t\t}\n\t\tmoviesContainer.removeChild(activeFeedback);\n\t\tactiveFeedback\t= null;\n\t}\n\n\t// Input placeholders\n\t(function(){\n\t\tvar inputs\t= document.getElementsByClassName('input--hinted'),\n\t\t\tactiveClass\t= 'input--active';\n\t\tfor(var i = 0; i < inputs.length; i++){\n\t\t\tvar input\t= inputs[i],\n\t\t\t\tfield\t= findOne(input, ['input']);\n\t\t\ttoggleClass(input, 'input--setup', true);\n\t\t\tfield.addEventListener('focus', function(){\n\t\t\t\ttoggleClass(this.parentNode, activeClass, true);\n\t\t\t});\n\t\t\tfield.addEventListener('blur', function(){\n\t\t\t\tvar field\t= this;\n\t\t\t\twindow.setTimeout(function(){\n\t\t\t\t\tvar isActive = (field.value !== field.defaultValue);\n\t\t\t\t\ttoggleClass(field.parentNode, activeClass, isActive);\n\t\t\t\t}());\n\t\t\t});\n\t\t}\n\t}());\n\n\t// Size toggle\n\t(function(){\n\t\tvar elements\t= document.getElementsByClassName('movies'),\n\t\t\tclasses\t\t= (elements.length ? elements[0].className : '');\n\t\tvar toggle\t= function(e){\n\t\t\tvar state\t= e.target.value;\n\n\t\t\tfor(var i = 0; i < elements.length; i++){\n\t\t\t\telements[i].className\t= classes+' movies--'+state;\n\t\t\t}\n\t\t};\n\n\t\tvar e;\n\t\te = document.getElementById('search-filter-size-toggle-full');\n\t\te && e.addEventListener('change', toggle);\n\t\te = document.getElementById('search-filter-size-toggle-compact');\n\t\te && e.addEventListener('change', toggle);\n\t}());\n\n\t// Filtering logic\n\tvar applyFilters,\n\t\tmoviesData,\n\t\tvenues;\n\tvar filterListeners\t= [];\n\tvar filterValues\t= {};\n\tvar dates\t\t= {},\n\t\thasDates\t= false;\n\n\t(function(){\n\t\t// Load venues data\n\t\tvar venueElements\t= document.getElementsByClassName('venue-details');\n\t\tvenues\t= {};\n\n\t\tvar getVenueText\t\t= function(element){\n\t\t\tif(!element){\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tvar text\t= getText(element);\n\t\t\treturn text === '' ? null : text;\n\t\t};\n\t\tvar getVenueAttribute\t= function(element, attr){\n\t\t\tif(!element){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar text\t= element.getAttribute(attr);\n\t\t\treturn (text == null || text === '') ? null : text;\n\t\t};\n\n\t\tfor(var i = 0; i < venueElements.length; i++){\n\t\t\tvar element\t= venueElements[i];\n\n\t\t\tvar venueID\t= element.id.substr(6); // Remove 'venue-' prefix\n\n\t\t\t// Parse coordinates\n\t\t\tvar coords\t= element.getAttribute('data-coords');\n\t\t\tif(coords){\n\t\t\t\tcoords\t= coords.split(',');\n\t\t\t\tif(coords.length === 2){\n\t\t\t\t\tcoords\t= {lat: parseFloat(coords[0]), lng: parseFloat(coords[1])};\n\t\t\t\t} else {\n\t\t\t\t\tcoords\t= null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvenues[venueID]\t= {\n\t\t\t\telement:\t\telement,\n\t\t\t\tid:\t\t\t\tvenueID,\n\t\t\t\ttitle:\t\t\tgetVenueText(findOne(element, ['.venue-details__name'])),\n\t\t\t\tborough:\t\tgetVenueAttribute(element, 'data-borough'),\n\t\t\t\tlocation:\t\tgetVenueText(findOne(element, ['.venue-details__location'])),\n\t\t\t\tdescription:\tgetVenueText(findOne(element, ['.venue-details__name'])),\n\t\t\t\twebsite:\t\tgetVenueAttribute(findOne(element, ['.venue-details__action--website', 'a']), 'href'),\n\t\t\t\tfacebook:\t\tgetVenueAttribute(findOne(element, ['.venue-details__action--social--facebook', 'a']), 'href'),\n\t\t\t\ttwitter:\t\tgetVenueAttribute(findOne(element, ['.venue-details__action--social--twitter', 'a']), 'href'),\n\t\t\t\tfoursquare:\t\tgetVenueAttribute(findOne(element, ['.venue-details__action--social--foursquare', 'a']), 'href'),\n\t\t\t\timage:\t\t\tgetVenueAttribute(element, 'data-image'),\n\t\t\t\tcoords:\t\t\tcoords,\n\t\t\t\tmovies:\t\t\t[],\n\t\t\t};\n\t\t}\n\t}());\n\n\t(function(){\n\t\t// Load movie data\n\t\tmoviesData\t= {};\n\t\tfor(var i = 0; i < movieElements.length; i++){\n\t\t\tvar element\t= movieElements[i];\n\n\t\t\t// Extract data\n\t\t\tvar titleBlock\t= findOne(element, ['.movie__title']),\n\t\t\t\ttitle\t\t= getText(findOne(titleBlock, ['.movie__title__name'])),\n\t\t\t\tyear\t\t= getText(findOne(titleBlock, ['.movie__title__year'])),\n\t\t\t\trating\t\t= getText(findOne(titleBlock, ['.movie__title__rating', 2]));\n\t\t\tvar detailsBlock\t= findOne(element, ['.movie__details']),\n\t\t\t\tvenueElement\t= findOne(detailsBlock, ['.movie__detail--venue', 'a']),\n\t\t\t\tdateElement\t\t= findOne(detailsBlock, ['.movie__detail--date', 'time']);\n\t\t\tvar dateString\t= dateElement ? dateElement.getAttribute('datetime') : null,\n\t\t\t\tdate\t\t= dateElement ? new Date(dateString) : null;\n\n\t\t\t// Link venue details\n\t\t\tvar venue\t= null;\n\t\t\tif(venueElement){\n\t\t\t\tvar venueID\t= venueElement.getAttribute('href').substr(7); // Remove '#venue-'\n\t\t\t\tvenue\t= venues[venueID];\n\t\t\t}\n\n\t\t\tvar movieData\t= {\n\t\t\t\telement:\telement,\n\t\t\t\tid:\t\telement.id,\n\t\t\t\ttitle:\ttitle,\n\t\t\t\tyear:\tyear,\n\t\t\t\trating:\trating,\n\t\t\t\tdate:\tdate,\n\t\t\t\tvenue:\tvenue,\n\t\t\t\tfree:\t(element.getAttribute('data-free') === '1'),\n\t\t\t};\n\n\t\t\tmoviesData[element.id]\t= movieData;\n\t\t\tif(venue){\n\t\t\t\tvenue.movies.push(movieData)\n\t\t\t}\n\n\t\t\tif(!date){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!dates[date]){\n\t\t\t\tdates[date]\t= {\n\t\t\t\t\tdate:\t\tdate,\n\t\t\t\t\telements:\t[],\n\t\t\t\t};\n\t\t\t\thasDates\t= true;\n\t\t\t}\n\t\t\tdates[date].elements.push(dateElement);\n\t\t}\n\n\t\tfunction filterData(filters){\n\t\t\tvar subset\t= {};\n\t\t\tfor(var id in moviesData){ if(!moviesData.hasOwnProperty(id)){ continue; }\n\t\t\t\tvar movie\t= moviesData[id];\n\n\t\t\t\tvar match\t= true;\n\t\t\t\tfor(var filter in filters){ if(!filters.hasOwnProperty(filter)){ continue; }\n\t\t\t\t\tvar value\t= filters[filter],\n\t\t\t\t\t\tsteps\t= filter.split('.'),\n\t\t\t\t\t\tlevel\t= movie;\n\t\t\t\t\tfor(var i = 0; i < steps.length && level != null; i++){\n\t\t\t\t\t\tvar step\t= steps[i];\n\t\t\t\t\t\tlevel\t\t= level[step];\n\t\t\t\t\t}\n\t\t\t\t\tif(!level || !match){\n\t\t\t\t\t\tmatch\t= false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(level !== value){\n\t\t\t\t\t\tmatch\t= false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(match){\n\t\t\t\t\tsubset[id]\t= movie;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn subset;\n\t\t}\n\n\t\tapplyFilters\t= function(filters){\n\t\t\tvar newData\t\t\t= filterData(filters),\n\t\t\t\tinvalidClass\t= '__filtered-out',\n\t\t\t\tcurrentMonth\t\t= null,\n\t\t\t\tcurrentMonthCount\t= 0;\n\n\t\t\tvar handleMonth\t= function(month, count){\n\t\t\t\tif(!month){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttoggleClass(month.previousSibling.previousSibling, invalidClass, (count === 0));\n\t\t\t};\n\n\t\t\t// Check each element for validity\n\t\t\tvar validItemsCount\t= 0;\n\t\t\tfor(var i = 0; i < movieElements.length; i++){\n\t\t\t\tvar element\t= movieElements[i];\n\n\t\t\t\t// Check for switching months\n\t\t\t\tvar thisMonth\t= element.parentNode;\n\t\t\t\tif(currentMonth !== thisMonth){\n\t\t\t\t\t// Changed months\n\t\t\t\t\thandleMonth(currentMonth, currentMonthCount);\n\t\t\t\t\tcurrentMonth\t\t= thisMonth;\n\t\t\t\t\tcurrentMonthCount\t= 0;\n\t\t\t\t}\n\n\t\t\t\t// Update element visibility\n\t\t\t\tvar isValid\t= newData[element.id];\n\t\t\t\ttoggleClass(element, invalidClass, !isValid);\n\t\t\t\tif(isValid){\n\t\t\t\t\tvalidItemsCount++;\n\t\t\t\t\tcurrentMonthCount++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(validItemsCount > 0){\n\t\t\t\tclearFeedback();\n\t\t\t} else {\n\t\t\t\tshowFeedback('no-results');\n\t\t\t}\n\n\t\t\thandleMonth(currentMonth, currentMonthCount);\n\n\t\t\tfor(i = 0; i < filterListeners.length; i++){\n\t\t\t\tfilterListeners[i](newData, filters);\n\t\t\t}\n\t\t};\n\t}());\n\tfunction setFilters(newValues, apply){\n\t\tfor(var filter in newValues){ if(!newValues.hasOwnProperty(filter)){ continue; }\n\t\t\tvar value\t= newValues[filter];\n\n\t\t\tif(value == null || value === ''){\n\t\t\t\tdelete filterValues[filter];\n\t\t\t} else {\n\t\t\t\tfilterValues[filter]\t= value;\n\t\t\t}\n\t\t}\n\t\tif(apply || apply === undefined){\n\t\t\tapplyFilters(filterValues);\n\t\t}\n\t}\n\tfunction setFilter(filter, value, apply){\n\t\tvar values\t= {};\n\t\tvalues[filter]\t= value;\n\t\tsetFilters(values, apply);\n\t}\n\tfunction addFilterListener(fn){\n\t\tfilterListeners.push(fn);\n\t}\n\n\t// Filtering interactivity\n\tvar resetFilters;\n\t(function(){\n\t\tvar handler\t= function(e){\n\t\t\tvar filter\t= this.getAttribute('name').replace(/^filter-/, ''),\n\t\t\t\tvalue\t= this.value;\n\n\t\t\tif(this.getAttribute('type') === 'checkbox'){\n\t\t\t\tvar toggleOn\t= value,\n\t\t\t\t\ttoggleOff\t= null;\n\t\t\t\tif(value === '1'){\n\t\t\t\t\ttoggleOn\t= true;\n\t\t\t\t}\n\t\t\t\tvalue\t= this.checked ? toggleOn : toggleOff;\n\t\t\t}\n\n\t\t\tvar apply\t= !!e;\n\t\t\tsetFilter(filter, value, apply);\n\t\t};\n\t\tvar filterElements\t= find(document, ['.search-filter--filter']),\n\t\t\tfilterInputs\t= [];\n\t\tif(!filterElements){\n\t\t\treturn;\n\t\t}\n\n\t\tfor(var i = 0; i < filterElements.length; i++){\n\t\t\tvar filterContainer\t= filterElements[i],\n\t\t\t\tfilter\t\t\t= findOne(filterContainer, ['input']) || findOne(filterContainer, ['select']);\n\n\t\t\tfilter.addEventListener('change', handler);\n\t\t\tfilterInputs.push(filter);\n\t\t}\n\n\t\tvar manualEvent;\n\t\tresetFilters\t= function(){\n\t\t\tmanualEvent || (manualEvent = new MouseEvent('click', {\n\t\t\t\t'view':       window,\n\t\t\t\t'bubbles':    true,\n\t\t\t\t'cancelable': true\n\t\t\t}));\n\t\t\tfor(var i = 0; i < filterInputs.length; i++){\n\t\t\t\tvar filter\t= filterInputs[i];\n\n\t\t\t\tswitch(filter.nodeName){\n\t\t\t\t\tcase 'SELECT':\n\t\t\t\t\t\tfor(var j = 0; j < filter.childNodes.length; j++){\n\t\t\t\t\t\t\tvar option\t= filter.childNodes[j];\n\t\t\t\t\t\t\toption.selected\t= option.defaultSelected;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'INPUT':\n\t\t\t\t\t\tvar setValue\t= true;\n\t\t\t\t\t\tswitch(filter.getAttribute('type')){\n\t\t\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\t\tcase 'radio':\n\t\t\t\t\t\t\t\tfilter.checked\t= filter.defaultChecked;\n\t\t\t\t\t\t\t\tsetValue\t= false;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!setValue){\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Fallthrough\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tfilter.value\t= filter.defaultValue;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t// Update filter value\n\t\t\t\thandler.call(filter);\n\t\t\t}\n\n\t\t\t// Apply updated filters\n\t\t\tapplyFilters(filterValues);\n\t\t};\n\t}());\n\n\t// Weather forecasts\n\tvar weatherLocationID\t= 2459115;\t// New York, NY\n\thasDates && window.Weather(weatherLocationID, 'f', function(weather){\n\t\tif(!weather){\n\t\t\t// Failed loading weather\n\t\t\treturn;\n\t\t}\n\n\t\tvar formatDate\t= function(date){\n\t\t\treturn date.getFullYear()+'-'+(date.getMonth()+1)+'-'+date.getDate();\n\t\t};\n\n\t\tvar forecasts\t= {},\n\t\t\tforecast;\n\t\tfor(var i = 0; i < weather.forecast.length; i++){\n\t\t\tforecast\t= weather.forecast[i];\n\t\t\tvar forecastDate\t= new Date(forecast.date);\n\n\t\t\tforecasts[formatDate(forecastDate)]\t= forecast;\n\t\t}\n\n\t\tvar template;\n\t\tvar outputElements\t= [];\n\t\tfor(var _ in dates){ if(!dates.hasOwnProperty(_)){ continue; }\n\t\t\tvar data\t= dates[_],\n\t\t\t\tdate\t= formatDate(data.date);\n\t\t\tif(!forecasts[date]){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tforecast\t= forecasts[date];\n\n\t\t\t// Show forecast\n\t\t\tif(!template){\n\t\t\t\ttemplate\t= document.getElementById('template-weather').innerHTML;\n\t\t\t}\n\n\t\t\tfor(i = 0; i < data.elements.length; i++){\n\t\t\t\tvar element\t= data.elements[i],\n\t\t\t\t\toutput\t= loadTemplate(template, true).firstChild;\n\t\t\t\toutput.setAttribute('data-conditions', forecast.code);\n\t\t\t\tsetText(findOne(output, ['.forecast__temperature']), forecast.high+'ยบ');\n\t\t\t\tsetText(findOne(output, ['.forecast__conditions']), forecast.text);\n\t\t\t\tfindOne(output, ['.forecast__link']).setAttribute('href', weather.link);\n\n\t\t\t\telement.parentNode.appendChild(output);\n\n\t\t\t\ttoggleClass(output, '__transitioning', true);\n\t\t\t\toutputElements.push(output);\n\t\t\t}\n\t\t}\n\n\t\tif(!outputElements.length){\n\t\t\treturn;\n\t\t}\n\n\t\t// Trigger entrance animations\n\t\tvar entranceIndex\t\t= 0,\n\t\t\tentranceInterval\t= window.setInterval(function(){\n\t\t\t\ttoggleClass(outputElements[entranceIndex], '__transitioning', false);\n\n\t\t\t\tentranceIndex++;\n\t\t\t\tif(entranceIndex >= outputElements.length){\n\t\t\t\t\twindow.clearInterval(entranceInterval);\n\t\t\t\t}\n\t\t\t}, 250);\n\t});\n\n\t// Map\n\tvar mapStyles\t= (function(){\n\t\tvar on\t\t={visibility:'on'},\n\t\t\toff\t\t={visibility:'off'},\n\t\t\tonlyOff\t=[off];\n\t\treturn [\n\t\t\t{\n\t\t\t\t\"featureType\": \"all\",\n\t\t\t\t\"elementType\": \"labels\",\n\t\t\t\t\"stylers\": onlyOff\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"administrative\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\toff,\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#efebe2\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"administrative.country\",\n\t\t\t\t\"elementType\": \"geometry\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\toff,\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#ff0000\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"administrative.country\",\n\t\t\t\t\"elementType\": \"geometry.fill\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#893b00\"\n\t\t\t\t\t},\n\t\t\t\t\ton\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"administrative.country\",\n\t\t\t\t\"elementType\": \"geometry.stroke\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\ton,\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#ddd4cb\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"administrative.country\",\n\t\t\t\t\"elementType\": \"labels.text\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\ton,\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#343434\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"administrative.country\",\n\t\t\t\t\"elementType\": \"labels.text.stroke\",\n\t\t\t\t\"stylers\": onlyOff\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"administrative.country\",\n\t\t\t\t\"elementType\": \"labels.icon\",\n\t\t\t\t\"stylers\": onlyOff\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"landscape\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#efebe2\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"poi\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#efebe2\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"poi.attraction\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#efebe2\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"poi.business\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#efebe2\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"poi.government\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#dfdcd5\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"poi.medical\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#dfdcd5\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"poi.park\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#bad294\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"poi.place_of_worship\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#efebe2\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"poi.school\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#efebe2\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"poi.sports_complex\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#efebe2\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"road\",\n\t\t\t\t\"elementType\": \"labels.text\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\ton,\n\t\t\t\t\t{\n\t\t\t\t\t\t\"lightness\": \"50\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\t\"saturation\": \"-100\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"road.highway\",\n\t\t\t\t\"elementType\": \"geometry.fill\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#ffffff\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"road.highway\",\n\t\t\t\t\"elementType\": \"geometry.stroke\",\n\t\t\t\t\"stylers\": onlyOff\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"road.arterial\",\n\t\t\t\t\"elementType\": \"geometry.fill\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#ffffff\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"road.arterial\",\n\t\t\t\t\"elementType\": \"geometry.stroke\",\n\t\t\t\t\"stylers\": onlyOff\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"road.local\",\n\t\t\t\t\"elementType\": \"geometry.fill\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#fbfbfb\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"road.local\",\n\t\t\t\t\"elementType\": \"geometry.stroke\",\n\t\t\t\t\"stylers\": onlyOff\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"transit\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": onlyOff\n\t\t\t},\n\t\t\t{\n\t\t\t\t\"featureType\": \"water\",\n\t\t\t\t\"elementType\": \"all\",\n\t\t\t\t\"stylers\": [\n\t\t\t\t\t{\n\t\t\t\t\t\t\"color\": \"#a5d7e0\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t];\n\t}());\n\n\tfunction Map(maps, element){\n\t\tthis.Maps\t\t= maps;\n\t\tthis.element\t= element;\n\t\tthis.map\t\t= null;\n\t\tthis.activeVenue\t= null;\n\n\t\tthis.markers\t= {};\n\n\t\tthis.moviesInteractive\t= false;\n\t\tthis.maxZoom\t\t\t= 15;\n\t}\n\n\tMap.prototype.show\t\t\t\t= function(center){\n\t\tvar options\t= {\n\t\t\tstyles:\t\t\t\tmapStyles,\n\t\t\tmapTypeControl:\t\tfalse,\n\t\t\tscaleControl:\t\tfalse,\n\t\t\tstreetViewControl:\tfalse,\n\t\t\trotateControl:\t\tfalse,\n\t\t\tfullscreenControl:\tfalse,\n\t\t\tzoomControl:\t\ttrue,\n\t\t\tzoomControlOptions:\t{\n\t\t\t\tposition:\tthis.Maps.ControlPosition.LEFT_BOTTOM\n\t\t\t}\n\t\t};\n\t\tif(center){\n\t\t\toptions.center\t= center;\n\t\t\tif(center.zoom){\n\t\t\t\toptions.zoom\t= center.zoom;\n\t\t\t}\n\t\t}\n\n\t\t// Prevent loading webfont\n\t\tvar head\t\t\t= document.getElementsByTagName('head')[0],\n\t\t\tinsertBefore\t= head.insertBefore;\n\t\thead.insertBefore\t= function(newElement, referenceElement){\n\t\t\tif(!newElement.href || newElement.href.indexOf('https://fonts.googleapis.com/css?family=Roboto') !== 0){\n\t\t\t\tinsertBefore.call(head, newElement, referenceElement);\n\t\t\t}\n\t\t};\n\n\t\tthis.map\t= new this.Maps.Map(this.element, options);\n\t};\n\tMap.prototype.loadVenues\t\t= function(venues){\n\t\tvar _this\t= this,\n\t\t\thandler\t= function(event){\n\t\t\t\tvar venue\t= this.dataVenue,\n\t\t\t\t\tfilter\t= (event.filter === undefined || event.filter);\n\t\t\t\tif(_this.activeVenue === venue && !event.manual){\n\t\t\t\t\t_this.deactivateVenue(venue);\n\t\t\t\t\tfilter && setFilters({\n\t\t\t\t\t\tvenue:\tnull\n\t\t\t\t\t});\n\t\t\t\t\t_this.moviesInteractive\t= true;\n\t\t\t\t} else {\n\t\t\t\t\t_this.activateVenue(venue, true, !filter);\n\t\t\t\t\tfilter && setFilters({\n\t\t\t\t\t\tvenue:\tthis.dataVenue,\n\t\t\t\t\t});\n\t\t\t\t\t_this.moviesInteractive\t= false;\n\t\t\t\t}\n\t\t\t};\n\n\t\tthis.map.addListener('click', function(){\n\t\t\tif(_this.activeVenue && !_this.moviesInteractive){\n\t\t\t\t_this.deactivateVenue(_this.activeVenue);\n\t\t\t\tsetFilters({\n\t\t\t\t\tvenue:\tnull\n\t\t\t\t});\n\t\t\t\t_this.moviesInteractive\t= true;\n\t\t\t}\n\t\t});\n\n\t\tfor(var id in venues){ if(!venues.hasOwnProperty(id)){ continue; }\n\t\t\tvar venue\t= venues[id];\n\t\t\tif(!venue.coords){\n\t\t\t\t// Cannot show venue on map\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar marker\t= this.buildMarker(venue.coords, handler, venue);\n\t\t\tthis.markerForVenue(venue, marker);\n\t\t}\n\n\t\tthis.fitMap();\n\n\t\tthis.monitorMovies(venues);\n\n\t\t// Reposition once ready\n\t\tthis.Maps.event.addListenerOnce(this.map, 'idle', function(){\n\t\t\t_this.fitMap();\n\t\t});\n\t};\n\tMap.prototype.buildMarker\t\t= function(coords, handler, venue){\n\t\tvar marker\t= new this.Maps.Marker({\n\t\t\tmap:\t\tthis.map,\n\t\t\tposition:\tcoords,\n\t\t});\n\t\tmarker.addListener('click', handler);\n\t\tmarker.dataVenue\t= venue;\n\n\t\tthis.unhighlightMarker(marker);\n\n\t\treturn marker;\n\t};\n\tMap.prototype.activateVenue\t\t= function(venue, showInfo, focus){\n\t\tvar showLabel\t= true;\n\t\tvar marker\t\t= this.markerForVenue(venue);\n\n\t\tif(this.activeVenue){\n\t\t\tif(this.activeVenue === venue){\n\t\t\t\tif(!showInfo || marker.detailsPanel){\n\t\t\t\t\t// Activating already-active venue - ignore\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\t// Need to show panel for active label\n\t\t\t\t\tshowLabel\t= false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Clear currently-active venue\n\t\t\t\tthis.deactivateVenue(this.activeVenue);\n\t\t\t}\n\t\t}\n\n\t\tif(showLabel){\n\t\t\tthis.activeVenue\t= venue;\n\n\t\t\t// Highlight marker\n\t\t\tthis.highlightMarker(marker);\n\n\t\t\t// Show label\n\t\t\tmarker.label\t= this.buildLabel(venue);\n\t\t\tmarker.label.open(this.map, marker);\n\t\t}\n\n\t\tif(showInfo){\n\t\t\t// Show full details\n\t\t\tvar element\t= this.getVenuePanel(venue),\n\t\t\t\toverlay\t= loadTemplate(document.getElementById('template-venue-dismiss').innerHTML).firstChild;\n\n\t\t\ttoggleClass(element, '__active', true);\n\t\t\ttoggleClass(element, '__transitioning', true);\n\t\t\ttoggleClass(overlay, '__transitioning', true);\n\t\t\telement.style.display\t= 'block';\n\t\t\twindow.setTimeout(function(){\n\t\t\t\ttoggleClass(element, '__transitioning', false);\n\t\t\t\ttoggleClass(overlay, '__transitioning', false);\n\t\t\t}, 0);\n\n\t\t\tmarker.detailsPanel\t= element;\n\n\t\t\t// Setup overlay\n\t\t\tvar _this\t= this;\n\t\t\telement.__private_overlay__\t= overlay;\n\t\t\tinsertBefore(overlay, element.parentNode.nextSibling);\n\t\t\toverlay.addEventListener('click', function(){\n\t\t\t\t_this.deactivateVenue(venue);\n\t\t\t});\n\t\t}\n\n\t\tif(focus){\n\t\t\tthis.map.setCenter(marker.getPosition());\n\t\t\tthis.map.setZoom(this.maxZoom);\n\t\t}\n\t};\n\tMap.prototype.deactivateVenue\t= function(venue){\n\t\tif(this.activeVenue === venue){\n\t\t\t// Clear active venue\n\t\t\tthis.activeVenue\t= null;\n\t\t}\n\n\t\tvar marker\t= this.markerForVenue(venue);\n\t\tthis.unhighlightMarker(marker);\n\n\t\tif(marker.label){\n\t\t\tmarker.label.close();\n\t\t\tmarker.label\t= null;\n\t\t}\n\n\t\tif(marker.detailsPanel){\n\t\t\tvar element\t= marker.detailsPanel,\n\t\t\t\toverlay\t= element.__private_overlay__;\n\t\t\tmarker.detailsPanel\t= null;\n\n\t\t\ttoggleClass(element, '__transitioning', true);\n\t\t\tif(overlay){\n\t\t\t\ttoggleClass(overlay, '__transitioning', true);\n\t\t\t}\n\t\t\tonTransitionEnd(element, function(){\n\t\t\t\ttoggleClass(element, '__active', false);\n\t\t\t\tif(overlay){\n\t\t\t\t\tremoveNode(overlay);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n\tMap.prototype.highlightMarker\t= function(marker){\n\t\tmarker.setIcon(this.pinIcons.on);\n\t\tmarker.setZIndex(this.Maps.Marker.MAX_ZINDEX + 1);\n\t};\n\tMap.prototype.unhighlightMarker\t= function(marker){\n\t\tmarker.setIcon(this.pinIcons.off);\n\t\tmarker.setZIndex(1);\n\t};\n\tMap.prototype.markerForVenue\t= function(venue, marker){\n\t\tif(marker){\n\t\t\tthis.markers[venue.id]\t= marker;\n\t\t}\n\t\treturn this.markers[venue.id];\n\t};\n\tMap.prototype.fitMap\t\t\t= function(bounds){\n\t\tif(!bounds || bounds.isEmpty()){\n\t\t\t// No bounds - show all\n\t\t\tbounds = new this.Maps.LatLngBounds();\n\n\t\t\tfor(var venueID in this.markers){\tif(!this.markers.hasOwnProperty(venueID)){ continue; }\n\t\t\t\tbounds.extend(this.markers[venueID].getPosition());\n\t\t\t}\n\t\t}\n\n\t\tif(bounds.isEmpty()){\n\t\t\t// Nothing to show\n\t\t\treturn;\n\t\t}\n\n\t\tthis.map.fitBounds(bounds);\n\t\tif(this.map.getZoom() > this.maxZoom){\n\t\t\tthis.map.setZoom(this.maxZoom);\n\t\t}\n\t};\n\n\tMap.prototype.buildLabel\t\t= function(venue){\n\t\tvar label\t= new this.Maps.InfoWindow({\n\t\t\ttitle:\t\tvenue.title,\n\t\t\tcontent:\tvenue.title,\n\t\t});\n\n\t\t// Hide stock infowindow UI elements\n\t\tthis.Maps.event.addListenerOnce(label, 'domready', function(){\n\t\t\tvar container\t= document.getElementsByClassName('gm-style-iw')[0].parentNode;\n\t\t\tcontainer.className\t+= ' map-infowindow';\n\t\t});\n\t\treturn label;\n\t};\n\tMap.prototype.getVenuePanel\t\t= function(venue){\n\t\tvar element\t= venue.element;\n\n\t\t// Load image\n\t\tif(venue.image && !venue.imageLoaded){\n\t\t\tvar imageContainer\t= loadTemplate(document.getElementById('template-venue-image').innerHTML, true).firstChild,\n\t\t\t\timage\t\t\t= findOne(imageContainer, ['img']);\n\n\t\t\timage.setAttribute('alt', venue.title);\n\t\t\timage.setAttribute('src', venue.image);\n\n\t\t\tinsertBefore(imageContainer, element.firstChild);\n\n\t\t\t// Prevent reloading image\n\t\t\tvenue.imageLoaded\t= true;\n\t\t}\n\n\t\treturn element;\n\t};\n\n\tMap.prototype.monitorMovies\t\t= function(){\n\t\tvar _this\t= this;\n\n\t\tvar callbackOver\t= function(){\n\t\t\tif(!_this.moviesInteractive){\n\t\t\t\t// Interactivity disabled\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(this.isOver){\n\t\t\t\t// Suppress multiple over's\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Mark element as over\n\t\t\tthis.isOver\t= true;\n\n\t\t\t_this.activateVenue(this.__private_venue__);\n\t\t};\n\t\tvar callbackOut\t\t= function(e){\n\t\t\tif(!_this.moviesInteractive){\n\t\t\t\t// Interactivity disabled\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Only handle leaving the parent element\n\t\t\tif(e.target !== this){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Mark element as exited\n\t\t\tthis.isOver\t= false;\n\n\t\t\t_this.deactivateVenue(this.__private_venue__);\n\t\t};\n\t\tvar callbackVenueClick\t= function(e){\n\t\t\te.preventDefault();\n\t\t\tvar venue\t= this.__private_venue__,\n\t\t\t\tmarker\t= _this.markerForVenue(venue);\n\n\t\t\t_this.Maps.event.trigger(marker, 'click', {manual: true, filter: false});\n\t\t};\n\n\t\tthis.moviesInteractive\t= true;\n\t\tfor(var venueID in venues){ if(!venues.hasOwnProperty(venueID)){ continue; }\n\t\t\tvar venue\t= venues[venueID];\n\t\t\tfor(var i = 0; i < venue.movies.length; i++){\n\t\t\t\tvar element\t= venue.movies[i].element;\n\t\t\t\telement.__private_venue__\t= venue;\n\t\t\t\telement.addEventListener('mouseover', callbackOver, true);\n\t\t\t\telement.addEventListener('mouseleave', callbackOut, true);\n\n\t\t\t\t// Show venue on venue name click\n\t\t\t\tvar venueElement\t= findOne(element, ['.movie__detail--venue', 'a']);\n\t\t\t\tvenueElement.__private_venue__\t= venue;\n\t\t\t\tvenueElement.addEventListener('click', callbackVenueClick, true);\n\t\t\t}\n\t\t}\n\t};\n\n\tMap.prototype.filterVenues\t\t= function(venuesSubset, fitMap){\n\t\tfitMap\t= fitMap || fitMap === undefined;\n\t\tvar bounds = new this.Maps.LatLngBounds();\n\t\tfor(var venueID in this.markers){ if(!this.markers.hasOwnProperty(venueID)){ continue; }\n\t\t\tvar isVisible\t= !!venuesSubset[venueID];\n\t\t\tvar marker\t= this.markers[venueID];\n\n\t\t\tmarker.setOpacity(isVisible ? 1 : 0.333);\n\t\t\tmarker.setClickable(isVisible);\n\n\t\t\tif(isVisible && fitMap){\n\t\t\t\tbounds.extend(marker.getPosition());\n\t\t\t}\n\t\t}\n\n\t\tif(fitMap){\n\t\t\tthis.fitMap(bounds);\n\t\t}\n\t};\n\n\t// Setup map on load\n\tvar map;\n\twindow.googleMapsReady\t= function(){\n\t\tvar element\t= document.getElementById('map'),\n\t\t\tMaps\t= window.google.maps;\n\n\t\tmap\t= new Map(Maps, element, moviesData);\n\t\tmap.show({lat: 40.771133, lng: -73.974187, zoom: 11});\n\n\t\t// Set icons\n\t\tvar pinImages\t= document.getElementById('pin-images').innerHTML.split('|'),\n\t\t\tscale\t\t= Math.min(1, (element.clientWidth+200) / 900);\t// Scale pin width according to map width\n\t\tmap.pinIcons\t= {\n\t\t\toff:\t{\n\t\t\t\tanchor:\t\tnew Maps.Point(18 * scale, 48 * scale),\n\t\t\t\turl:\t'data:image/svg+xml,'+encodeURIComponent(pinImages[0]),\n\t\t\t\tscaledSize:\tnew Maps.Size(36 * scale, 48 * scale)\n\t\t\t},\n\t\t\ton:\t\t{\n\t\t\t\tanchor:\t\tnew Maps.Point(26 * scale, 60 * scale),\n\t\t\t\turl:\t'data:image/svg+xml,'+encodeURIComponent(pinImages[1]),\n\t\t\t\tscaledSize:\tnew Maps.Size(52 * scale, 70 * scale)\n\t\t\t}\n\t\t};\n\t\tmap.loadVenues(venues);\n\n\t\t// Update on filter changes\n\t\taddFilterListener(function(movies){\n\t\t\t// Get remaining venues\n\t\t\tvar venues\t= {};\n\t\t\tfor(var id in movies){ if(!movies.hasOwnProperty(id)){ continue; }\n\t\t\t\tvar venue\t= movies[id].venue;\n\t\t\t\tif(venue){\n\t\t\t\t\tvenues[venue.id]\t= venue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Update map\n\t\t\tmap.filterVenues(venues);\n\t\t});\n\t};\n\t// Initialise if already loaded\n\twindow.google && window.googleMapsReady();\n}());\n"],"file":"main.js"}