!function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):this.Picker=e(jQuery)}(function(g){function v(r,i,a,e){function d(){return v._.node("div",v._.node("div",v._.node("div",v._.node("div",m.component.nodes(l.open),p.box),p.wrap),p.frame),p.holder,'tabindex="-1"')}function s(){m.$holder.on({keydown:c,"focus.toOpen":t,blur:function(){h.removeClass(p.target)},focusin:function(e){m.$root.removeClass(p.focused),e.stopPropagation()},"mousedown click":function(e){var t=e.target;t!=m.$holder[0]&&(e.stopPropagation(),"mousedown"!=e.type||g(t).is("input, select, textarea, button, option")||(e.preventDefault(),m.$holder[0].focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var e=g(this),t=e.data(),n=e.hasClass(p.navDisabled)||e.hasClass(p.disabled),o=_();o=o&&(o.type||o.href),(n||o&&!g.contains(m.$root[0],o))&&m.$holder[0].focus(),!n&&t.nav?m.set("highlight",m.component.item.highlight,{nav:t.nav}):!n&&"pick"in t?(m.set("select",t.pick),f.closeOnSelect&&m.close(!0)):t.clear?(m.clear(),f.closeOnClear&&m.close(!0)):t.close&&m.close(!0)})}function t(e){e.stopPropagation(),h.addClass(p.target),m.$root.addClass(p.focused),m.open()}function c(e){var t=e.keyCode,n=/^(8|46)$/.test(t);return 27==t?(m.close(!0),!1):void((32==t||n||!l.open&&m.component.key[t])&&(e.preventDefault(),e.stopPropagation(),n?m.clear().close():m.open()))}if(!r)return v;var u=!1,l={id:r.id||"P"+Math.abs(~~(Math.random()*new Date))},f=a?g.extend(!0,{},a.defaults,e):e||{},p=g.extend({},v.klasses(),f.klass),h=g(r),n=function(){return this.start()},m=n.prototype={constructor:n,$node:h,start:function(){return l&&l.start?m:(l.methods={},l.start=!0,l.open=!1,l.type=r.type,r.autofocus=r==_(),r.readOnly=!f.editable,r.id=r.id||l.id,"text"!=r.type&&(r.type="text"),m.component=new a(m,f),m.$root=g('<div class="'+p.picker+'" id="'+r.id+'_root" />'),y(m.$root[0],"hidden",!0),m.$holder=g(d()).appendTo(m.$root),s(),f.formatSubmit&&(!0===f.hiddenName?(o=r.name,r.name=""):o=(o=["string"==typeof f.hiddenPrefix?f.hiddenPrefix:"","string"==typeof f.hiddenSuffix?f.hiddenSuffix:"_submit"])[0]+r.name+o[1],m._hidden=g('<input type=hidden name="'+o+'"'+(h.data("value")||r.value?' value="'+m.get("select",f.formatSubmit)+'"':"")+">")[0],h.on("change."+l.id,function(){m._hidden.value=r.value?m.get("select",f.formatSubmit):""})),h.data(i,m).addClass(p.input).val(h.data("value")?m.get("select",f.format):r.value),f.editable||h.on("focus."+l.id+" click."+l.id,function(e){e.preventDefault(),m.open()}).on("keydown."+l.id,c),y(r,{haspopup:!0,expanded:!1,readonly:!1,owns:r.id+"_root"}),f.containerHidden?g(f.containerHidden).append(m._hidden):h.after(m._hidden),f.container?g(f.container).append(m.$root):h.after(m.$root),m.on({start:m.component.onStart,render:m.component.onRender,stop:m.component.onStop,open:m.component.onOpen,close:m.component.onClose,set:m.component.onSet}).on({start:f.onStart,render:f.onRender,stop:f.onStop,open:f.onOpen,close:f.onClose,set:f.onSet}),e=m.$holder[0],n="position",e.currentStyle?t=e.currentStyle[n]:window.getComputedStyle&&(t=getComputedStyle(e)[n]),u="fixed"==t,r.autofocus&&m.open(),m.trigger("start").trigger("render"));var e,t,n,o},render:function(e){return e?(m.$holder=g(d()),s(),m.$root.html(m.$holder)):m.$root.find("."+p.box).html(m.component.nodes(l.open)),m.trigger("render")},stop:function(){return l.start&&(m.close(),m._hidden&&m._hidden.parentNode.removeChild(m._hidden),m.$root.remove(),h.removeClass(p.input).removeData(i),setTimeout(function(){h.off("."+l.id)},0),r.type=l.type,r.readOnly=!1,m.trigger("stop"),l.methods={},l.start=!1),m},open:function(e){return l.open?m:(h.addClass(p.active),y(r,"expanded",!0),setTimeout(function(){m.$root.addClass(p.opened),y(m.$root[0],"hidden",!1)},0),!1!==e&&(l.open=!0,u&&b.css("overflow","hidden").css("padding-right","+="+o()),u&&k?m.$holder.find("."+p.frame).one("transitionend",function(){m.$holder[0].focus()}):m.$holder[0].focus(),$.on("click."+l.id+" focusin."+l.id,function(e){var t=e.target;t!=r&&t!=document&&3!=e.which&&m.close(t===m.$holder[0])}).on("keydown."+l.id,function(e){var t=e.keyCode,n=m.component.key[t],o=e.target;27==t?m.close(!0):o!=m.$holder[0]||!n&&13!=t?g.contains(m.$root[0],o)&&13==t&&(e.preventDefault(),o.click()):(e.preventDefault(),n?v._.trigger(m.component.key.go,m,[v._.trigger(n)]):m.$root.find("."+p.highlighted).hasClass(p.disabled)||(m.set("select",m.component.item.highlight),f.closeOnSelect&&m.close(!0)))})),m.trigger("open"))},close:function(e){return e&&(f.editable?r.focus():(m.$holder.off("focus.toOpen").focus(),setTimeout(function(){m.$holder.on("focus.toOpen",t)},0))),h.removeClass(p.active),y(r,"expanded",!1),setTimeout(function(){m.$root.removeClass(p.opened+" "+p.focused),y(m.$root[0],"hidden",!0)},0),l.open?(l.open=!1,u&&b.css("overflow","").css("padding-right","-="+o()),$.off("."+l.id),m.trigger("close")):m},clear:function(e){return m.set("clear",null,e)},set:function(e,t,n){var o,r,i=g.isPlainObject(e),a=i?e:{};if(n=i&&g.isPlainObject(t)?t:n||{},e){for(o in i||(a[e]=t),a)r=a[o],o in m.component.item&&(void 0===r&&(r=null),m.component.set(o,r,n)),("select"==o||"clear"==o)&&h.val("clear"==o?"":m.get(o,f.format)).trigger("change");m.render()}return n.muted?m:m.trigger("set",a)},get:function(e,t){if(null!=l[e=e||"value"])return l[e];if("valueSubmit"==e){if(m._hidden)return m._hidden.value;e="value"}if("value"==e)return r.value;if(e in m.component.item){if("string"==typeof t){var n=m.component.get(e);return n?v._.trigger(m.component.formats.toString,m.component,[t,n]):""}return m.component.get(e)}},on:function(e,t,n){var o,r,i=g.isPlainObject(e),a=i?e:{};if(e)for(o in i||(a[e]=t),a)r=a[o],n&&(o="_"+o),l.methods[o]=l.methods[o]||[],l.methods[o].push(r);return m},off:function(){var e,t,n=arguments;for(e=0,namesCount=n.length;e<namesCount;e+=1)(t=n[e])in l.methods&&delete l.methods[t];return m},trigger:function(e,n){var t=function(e){var t=l.methods[e];t&&t.map(function(e){v._.trigger(e,m,[n])})};return t("_"+e),t(e),m}};return new n}function o(){if(b.height()<=i.height())return 0;var e=g('<div style="visibility:hidden;width:100px" />').appendTo("body"),t=e[0].offsetWidth;e.css("overflow","scroll");var n=g('<div style="width:100%" />').appendTo(e)[0].offsetWidth;return e.remove(),t-n}function y(e,t,n){if(g.isPlainObject(t))for(var o in t)r(e,o,t[o]);else r(e,t,n)}function r(e,t,n){e.setAttribute(("role"==t?"":"aria-")+t,n)}function _(){try{return document.activeElement}catch(e){}}var i=g(window),$=g(document),b=g(document.documentElement),k=null!=document.documentElement.style.transition;return v.klasses=function(e){return{picker:e=e||"picker",opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",target:e+"__input--target",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},v._={group:function(e){for(var t,n="",o=v._.trigger(e.min,e);o<=v._.trigger(e.max,e,[o]);o+=e.i)t=v._.trigger(e.item,e,[o]),n+=v._.node(e.node,t[0],t[1],t[2]);return n},node:function(e,t,n,o){return t?"<"+e+(n=n?' class="'+n+'"':"")+(o=o?" "+o:"")+">"+(t=g.isArray(t)?t.join(""):t)+"</"+e+">":""},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,n){return"function"==typeof e?e.apply(t,n||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return-1<{}.toString.call(e).indexOf("Date")&&this.isInteger(e.getDate())},isInteger:function(e){return-1<{}.toString.call(e).indexOf("Number")&&e%1==0},ariaAttr:function(e,t){for(var n in g.isPlainObject(e)||(e={attribute:t}),t="",e){var o=("role"==n?"":"aria-")+n;t+=null==e[n]?"":o+'="'+e[n]+'"'}return t}},v.extend=function(o,r){g.fn[o]=function(e,t){var n=this.data(o);return"picker"==e?n:n&&"string"==typeof e?v._.trigger(n[e],n,[t]):this.each(function(){g(this).data(o)||new v(this,o,r,e)})},g.fn[o].defaults=r.defaults},v});