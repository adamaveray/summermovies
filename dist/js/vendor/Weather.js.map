{"version":3,"names":[],"mappings":"","sources":["vendor/Weather.js"],"sourcesContent":["/*! simpleWeather v3.1.0 - http://simpleweatherjs.com */\nwindow.Weather\t= (function(){\n\t'use strict';\n\n\tfunction getAltTemp(unit, temp){\n\t\tif(unit === 'c') {\n\t\t\t// C -> F\n\t\t\ttemp\t= (9.0/5.0) * temp + 32.0;\n\t\t} else {\n\t\t\t// F -> C\n\t\t\ttemp\t= (5.0/9.0) * (temp - 32.0);\n\t\t}\n\t\treturn Math.round(temp);\n\t}\n\n\tfunction getImage(code, image){\n\t\treturn 'https://s.yimg.com/'\n\t\t\t+ (code === '3200'\n\t\t\t\t// 404 image\n\t\t\t\t? 'os/mit/media/m/weather/images/icons/l/44d-100567.png'\n\t\t\t\t// Valid\n\t\t\t\t: 'zz/combo?a/i/us/nws/weather/gr/'+code+image+'.png'\n\t\t\t);\n\t}\n\n\tfunction doRequest(method, url, callback){\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.open(method, url, true);\n\t\trequest.onreadystatechange\t= function(){\n\t\t\tif(this.readyState !== 4){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcallback(this);\n\t\t};\n\t\trequest.send();\n\t\trequest\t= null;\n\t}\n\n\tfunction processResponse(data, unit){\n\t\tif(!data || !data.query || !data.query.results || !data.query.results.channel || !data.query.results.channel.description === 'Yahoo! Weather Error'){\n\t\t\t// Error with response\n\t\t\treturn null;\n\t\t}\n\n\t\tvar result\t\t= data.query.results.channel,\n\t\t\tcompass\t\t= ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW', 'N'];\n\n\t\tvar weather = {\n\t\t\tunit:\t\t\tunit,\n\t\t\ttitle:\t\t\tresult.item.title,\n\t\t\ttemp:\t\t\tresult.item.condition.temp,\n\t\t\tcode:\t\t\tresult.item.condition.code,\n\t\t\ttodayCode:\t\tresult.item.forecast[0].code,\n\t\t\tcurrently:\t\tresult.item.condition.text,\n\t\t\theatIndex:\t\tresult.item.condition.temp,\n\t\t\thigh:\t\t\tresult.item.forecast[0].high,\n\t\t\tlow:\t\t\tresult.item.forecast[0].low,\n\t\t\ttext:\t\t\tresult.item.forecast[0].text,\n\t\t\thumidity:\t\tresult.atmosphere.humidity,\n\t\t\tpressure:\t\tresult.atmosphere.pressure,\n\t\t\trising:\t\t\tresult.atmosphere.rising,\n\t\t\tvisibility:\t\tresult.atmosphere.visibility,\n\t\t\tsunrise:\t\tresult.astronomy.sunrise,\n\t\t\tsunset:\t\t\tresult.astronomy.sunset,\n\t\t\tdescription:\tresult.item.description,\n\t\t\tcity:\t\t\tresult.location.city,\n\t\t\tcountry:\t\tresult.location.country,\n\t\t\tregion:\t\t\tresult.location.region,\n\t\t\tupdated:\t\tresult.item.pubDate,\n\t\t\tlink:\t\t\tresult.item.link,\n\t\t\timage:\t\t\tgetImage(result.item.condition.code, 'd'),\n\t\t\tthumbnail:\t\tgetImage(result.item.condition.code, 'ds'),\n\t\t\tforecast:\t\t[],\n\t\t\tunits:\t{\n\t\t\t\ttemp:\t\tresult.units.temperature,\n\t\t\t\tdistance:\tresult.units.distance,\n\t\t\t\tpressure:\tresult.units.pressure,\n\t\t\t\tspeed:\t\tresult.units.speed\n\t\t\t},\n\t\t\twind:\t{\n\t\t\t\tchill:\t\tresult.wind.chill,\n\t\t\t\tdirection:\tcompass[Math.round(result.wind.direction / 22.5)],\n\t\t\t\tspeed:\t\tresult.wind.speed\n\t\t\t}\n\t\t};\n\n\t\t// Calculate alternate unit temperatures\n\t\tweather.alt = {\n\t\t\tunit:\t(unit === 'c') ? 'f' : 'c',\n\t\t\ttemp:\tgetAltTemp(unit, result.item.condition.temp),\n\t\t\thigh:\tgetAltTemp(unit, result.item.forecast[0].high),\n\t\t\tlow:\tgetAltTemp(unit, result.item.forecast[0].low)\n\t\t};\n\n\t\t// Calculate special heat index\n\t\tif(result.item.condition.temp < 80 && result.atmosphere.humidity < 40){\n\t\t\tweather.heatindex\t=\n\t\t\t\t-42.379 + 2.04901523\n\t\t\t\t* result.item.condition.temp + 10.14333127\n\t\t\t\t* result.atmosphere.humidity - 0.22475541\n\t\t\t\t* result.item.condition.temp\n\t\t\t\t* result.atmosphere.humidity - 6.83783\n\t\t\t\t* Math.pow(10, -3)\n\t\t\t\t* Math.pow(result.item.condition.temp, 2) - 5.481717\n\t\t\t\t* Math.pow(10, -2)\n\t\t\t\t* Math.pow(result.atmosphere.humidity, 2) + 1.22874\n\t\t\t\t* Math.pow(10, -3)\n\t\t\t\t* Math.pow(result.item.condition.temp, 2)\n\t\t\t\t* result.atmosphere.humidity + 8.5282\n\t\t\t\t* Math.pow(10, -4)\n\t\t\t\t* result.item.condition.temp\n\t\t\t\t* Math.pow(result.atmosphere.humidity, 2) - 1.99\n\t\t\t\t* Math.pow(10, -6)\n\t\t\t\t* Math.pow(result.item.condition.temp, 2)\n\t\t\t\t* Math.pow(result.atmosphere.humidity, 2);\n\t\t}\n\n\t\t// Load additional data for forecasted days\n\t\tfor(var i = 0; i < result.item.forecast.length; i++){\n\t\t\tvar forecast\t= result.item.forecast[i];\n\n\t\t\tforecast.alt = {\n\t\t\t\thigh:\tgetAltTemp(unit, result.item.forecast[i].high),\n\t\t\t\tlow:\tgetAltTemp(unit, result.item.forecast[i].low)\n\t\t\t};\n\t\t\tforecast.image\t\t= getImage(forecast.code, 'd');\n\t\t\tforecast.thumbnail\t= getImage(forecast.code, 'ds');\n\n\t\t\tweather.forecast.push(forecast);\n\t\t}\n\n\t\treturn weather;\n\t}\n\n\treturn function(location, unit, callback){\n\t\tvar condition;\n\t\tswitch(typeof location){\n\t\t\tcase 'number':\n\t\t\t\t// WOEID\n\t\t\t\tcondition\t= 'woeid='+location;\n\t\t\t\tbreak;\n\t\t\tcase 'string':\n\t\t\t\t// Location name - leave as is\n\t\t\t\tbreak;\n\t\t\tcase 'object':\n\t\t\t\t// Check for lat-lng\n\t\t\t\tif(location.lat != null && location.lng != null){\n\t\t\t\t\tlocation\t= '('+location.lat+','+location.lng+')';\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t// Fallthrough\n\t\t\tdefault:\n\t\t\t\tthrow new Error('Invalid location format');\n\t\t}\n\n\t\tif(!condition){\n\t\t\t// Text-based location\n\t\t\tcondition\t= 'woeid in (select woeid from geo.places(1) where text=\"'+location+'\")';\n\t\t}\n\n\t\t// Build request\n\t\tvar now\t\t= new Date(),\n\t\t\tquery\t= 'select * from weather.forecast where '+condition+' and u=\"'+unit+'\"',\n\t\t\turl\t\t= 'https://query.yahooapis.com/v1/public/yql?format=json&rnd='+encodeURIComponent(now.getFullYear()+now.getMonth()+now.getDay()+now.getHours())+'&diagnostics=true&q='+encodeURIComponent(query);\n\n\t\tdoRequest('GET', url, function(response){\n\t\t\tif(response.status < 200 || response.status >= 400){\n\t\t\t\t// Request failed\n\t\t\t\tcallback(response);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tvar responseData\t= JSON.parse(response.responseText);\n\t\t\t} catch(e){\n\t\t\t\tcallback();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar weather\t= processResponse(responseData, unit);\n\t\t\tcallback(weather);\n\t\t});\n\t};\n}());"],"file":"Weather.js"}