!function(){"use strict";function a(e){return String(e).replace(/^\s*(.*?)\s*$/m,"$1")}function s(e){return(e instanceof NodeList||e instanceof HTMLCollection)&&(e=0<e.length?e[0]:null),e}function v(e,t){var n=(e=s(e))?e.innerText||e.textContent:null;return null==n?null:((t||void 0===t)&&(n=a(n)),n)}function p(e,t){(e=s(e))&&("textContent"in e?e.textContent=t:e.innerText=t)}function l(e,t){for(var n=s(e),i=0;i<t.length&&null!=n;i++){var a=t[i];switch(e=s(n),n=null,typeof a){case"number":e&&e.childNodes&&e.childNodes.length>=a&&(n=e.childNodes[a]);break;case"string":if("."===a.substr(0,1))(n=e.getElementsByClassName(a.substr(1))).length||(n=null);else{a=a.toUpperCase();for(var r=0;r<e.childNodes.length;r++){var o=e.childNodes[r];if(null!=o.tagName&&o.tagName===a){n=o;break}}}break;default:throw new Error('Unknown step "'+a+'"')}}return n}function h(){return s(l.apply(this,arguments))}var r,t={};function u(e){return e instanceof RegExp||(t[e]||(t[e]=new RegExp("(^|\\s)"+e+"(\\s|$)","m")),e=t[e]),e}function y(e,t,n){var i,a,r=(i=e,a=u(t),!!i.className.match(a));if(n)r||(e.className+=" "+t);else if(r){var o=u(t);e.className=e.className.replace(o,"$1")}}function g(e,t){var n=document.createElement("div");n.innerHTML=a(e);var i=n;return(t||void 0===t)&&(i=s(i)),i}function c(e,t){return t.parentNode.insertBefore(e,t)}var _,e,i,o,n,b,T,w,k=document.getElementById("main"),M=document.getElementsByClassName("movie");function E(){_&&(k.removeChild(_),_=null)}!function(){for(var e=document.getElementsByClassName("input--hinted"),n="input--active",t=0;t<e.length;t++){var i=e[t],a=h(i,["input"]);y(i,"input--setup",!0),a.addEventListener("focus",function(){y(this.parentNode,n,!0)}),a.addEventListener("blur",function(){var e,t=this;window.setTimeout((e=t.value!==t.defaultValue,void y(t.parentNode,n,e)))})}}(),i=document.getElementsByClassName("movies"),o=i.length?i[0].className:"",n=function(e){for(var t=e.target.value,n=0;n<i.length;n++)i[n].className=o+" movies--"+t},(e=document.getElementById("search-filter-size-toggle-full"))&&e.addEventListener("change",n),(e=document.getElementById("search-filter-size-toggle-compact"))&&e.addEventListener("change",n);var V,N=[],f={},C={},L=!1;function d(e,t){for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];null==i||""===i?delete f[n]:f[n]=i}(t||void 0===t)&&b(f)}!function(){var e=document.getElementsByClassName("venue-details");w={};for(var t=function(e){if(!e)return null;var t=v(e);return""===t?null:t},n=function(e,t){if(e){var n=e.getAttribute(t);return null==n||""===n?null:n}},i=0;i<e.length;i++){var a=e[i],r=a.id.substr(6),o=a.getAttribute("data-coords");o&&(o=2===(o=o.split(",")).length?{lat:parseFloat(o[0]),lng:parseFloat(o[1])}:null),w[r]={element:a,id:r,title:t(h(a,[".venue-details__name"])),borough:n(a,"data-borough"),location:t(h(a,[".venue-details__location"])),description:t(h(a,[".venue-details__name"])),website:n(h(a,[".venue-details__action--website","a"]),"href"),facebook:n(h(a,[".venue-details__action--social--facebook","a"]),"href"),twitter:n(h(a,[".venue-details__action--social--twitter","a"]),"href"),foursquare:n(h(a,[".venue-details__action--social--foursquare","a"]),"href"),image:n(a,"data-image"),coords:o,movies:[]}}}(),function(){T={};for(var e=0;e<M.length;e++){var t=M[e],n=h(t,[".movie__title"]),i=v(h(n,[".movie__title__name"])),a=v(h(n,[".movie__title__year"])),r=v(h(n,[".movie__title__rating",2])),o=h(t,[".movie__details"]),s=h(o,[".movie__detail--venue","a"]),l=h(o,[".movie__detail--date","time"]),u=l?l.getAttribute("datetime"):null,c=l?new Date(u):null,f=null;if(s){var d=s.getAttribute("href").substr(7);f=w[d]}var m={element:t,id:t.id,title:i,year:a,rating:r,date:c,venue:f,free:"1"===t.getAttribute("data-free")};T[t.id]=m,f&&f.movies.push(m),c&&(C[c]||(C[c]={date:c,elements:[]},L=!0),C[c].elements.push(l))}b=function(e){for(var t=function(e){var t={};for(var n in T)if(T.hasOwnProperty(n)){var i=T[n],a=!0;for(var r in e)if(e.hasOwnProperty(r)){for(var o=e[r],s=r.split("."),l=i,u=0;u<s.length&&null!=l;u++)l=l[s[u]];if(!l||!a){a=!1;break}if(l!==o){a=!1;break}}a&&(t[n]=i)}return t}(e),n="__filtered-out",i=null,a=0,r=function(e,t){e&&y(e.previousSibling.previousSibling,n,0===t)},o=0,s=0;s<M.length;s++){var l=M[s],u=l.parentNode;i!==u&&(r(i,a),i=u,a=0);var c=t[l.id];y(l,n,!c),c&&(o++,a++)}for(0<o?E():function(e){E();var t=g(document.getElementById("template-"+e).innerHTML),n=h(t,[".search-feedback__reset"]);n&&n.addEventListener("click",function(){V()}),_=t,k.appendChild(_)}("no-results"),r(i,a),s=0;s<N.length;s++)N[s](t,e)}}(),function(){var r=function(e){var t,n,i=this.getAttribute("name").replace(/^filter-/,""),a=this.value;if("checkbox"===this.getAttribute("type")){var r=a;"1"===a&&(r=!0),a=this.checked?r:null}t=!!e,(n={})[i]=a,d(n,t)},e=l(document,[".search-filter--filter"]),o=[];if(e){for(var t=0;t<e.length;t++){var n=e[t],i=h(n,["input"])||h(n,["select"]);i.addEventListener("change",r),o.push(i)}var s;V=function(){s||(s=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}));for(var e=0;e<o.length;e++){var t=o[e];switch(t.nodeName){case"SELECT":for(var n=0;n<t.childNodes.length;n++){var i=t.childNodes[n];i.selected=i.defaultSelected}break;case"INPUT":var a=!0;switch(t.getAttribute("type")){case"checkbox":case"radio":t.checked=t.defaultChecked,a=!1}if(!a)break;default:t.value=t.defaultValue}r.call(t)}b(f)}}}();L&&window.Weather(2459115,"f",function(e){if(e){for(var t,n,i=function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},a={},r=0;r<e.forecast.length;r++){t=e.forecast[r],a[i(new Date(t.date))]=t}var o=[];for(var s in C)if(C.hasOwnProperty(s)){var l=C[s],u=i(l.date);if(a[u])for(t=a[u],n||(n=document.getElementById("template-weather").innerHTML),r=0;r<l.elements.length;r++){var c=l.elements[r],f=g(n,!0).firstChild;f.setAttribute("data-conditions",t.code),p(h(f,[".forecast__temperature"]),t.high+"ยบ"),p(h(f,[".forecast__conditions"]),t.text),e.link=(e.link||"").replace(/^.+(https?:\/\/)/,"$1"),h(f,[".forecast__link"]).setAttribute("href",e.link),c.parentNode.appendChild(f),y(f,"__transitioning",!0),o.push(f)}}if(o.length)var d=0,m=window.setInterval(function(){y(o[d],"__transitioning",!1),++d>=o.length&&window.clearInterval(m)},250)}});var m,I,x,P,B=[{featureType:"all",elementType:"labels",stylers:x=[I={visibility:"off"}]},{featureType:"administrative",elementType:"all",stylers:[I,{color:"#efebe2"}]},{featureType:"administrative.country",elementType:"geometry",stylers:[I,{color:"#ff0000"}]},{featureType:"administrative.country",elementType:"geometry.fill",stylers:[{color:"#893b00"},m={visibility:"on"}]},{featureType:"administrative.country",elementType:"geometry.stroke",stylers:[m,{color:"#ddd4cb"}]},{featureType:"administrative.country",elementType:"labels.text",stylers:[m,{color:"#343434"}]},{featureType:"administrative.country",elementType:"labels.text.stroke",stylers:x},{featureType:"administrative.country",elementType:"labels.icon",stylers:x},{featureType:"landscape",elementType:"all",stylers:[{color:"#efebe2"}]},{featureType:"poi",elementType:"all",stylers:[{color:"#efebe2"}]},{featureType:"poi.attraction",elementType:"all",stylers:[{color:"#efebe2"}]},{featureType:"poi.business",elementType:"all",stylers:[{color:"#efebe2"}]},{featureType:"poi.government",elementType:"all",stylers:[{color:"#dfdcd5"}]},{featureType:"poi.medical",elementType:"all",stylers:[{color:"#dfdcd5"}]},{featureType:"poi.park",elementType:"all",stylers:[{color:"#bad294"}]},{featureType:"poi.place_of_worship",elementType:"all",stylers:[{color:"#efebe2"}]},{featureType:"poi.school",elementType:"all",stylers:[{color:"#efebe2"}]},{featureType:"poi.sports_complex",elementType:"all",stylers:[{color:"#efebe2"}]},{featureType:"road",elementType:"labels.text",stylers:[m,{lightness:"50"},{saturation:"-100"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:x},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:x},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"#fbfbfb"}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:x},{featureType:"transit",elementType:"all",stylers:x},{featureType:"water",elementType:"all",stylers:[{color:"#a5d7e0"}]}];function O(e,t){this.Maps=e,this.element=t,this.map=null,this.activeVenue=null,this.markers={},this.moviesInteractive=!1,this.maxZoom=15}O.prototype.show=function(e){var t={styles:B,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!1,zoomControl:!0,zoomControlOptions:{position:this.Maps.ControlPosition.LEFT_BOTTOM}};e&&(t.center=e).zoom&&(t.zoom=e.zoom);var n=document.getElementsByTagName("head")[0],i=n.insertBefore;n.insertBefore=function(e,t){e.href&&0===e.href.indexOf("https://fonts.googleapis.com/css?family=Roboto")||i.call(n,e,t)},this.map=new this.Maps.Map(this.element,t)},O.prototype.loadVenues=function(e){var i=this,t=function(e){var t=this.dataVenue,n=void 0===e.filter||e.filter;i.activeVenue!==t||e.manual?(i.activateVenue(t,!0,!n),n&&d({venue:this.dataVenue}),i.moviesInteractive=!1):(i.deactivateVenue(t),n&&d({venue:null}),i.moviesInteractive=!0)};for(var n in this.map.addListener("click",function(){i.activeVenue&&!i.moviesInteractive&&(i.deactivateVenue(i.activeVenue),d({venue:null}),i.moviesInteractive=!0)}),e)if(e.hasOwnProperty(n)){var a=e[n];if(a.coords){var r=this.buildMarker(a.coords,t,a);this.markerForVenue(a,r)}}this.fitMap(),this.monitorMovies(e),this.Maps.event.addListenerOnce(this.map,"idle",function(){i.fitMap()})},O.prototype.buildMarker=function(e,t,n){var i=new this.Maps.Marker({map:this.map,position:e});return i.addListener("click",t),i.dataVenue=n,this.unhighlightMarker(i),i},O.prototype.activateVenue=function(e,t,n){var i=!0,a=this.markerForVenue(e);if(this.activeVenue)if(this.activeVenue===e){if(!t||a.detailsPanel)return;i=!1}else this.deactivateVenue(this.activeVenue);if(i&&(this.activeVenue=e,this.highlightMarker(a),a.label=this.buildLabel(e),a.label.open(this.map,a)),t){var r=this.getVenuePanel(e),o=g(document.getElementById("template-venue-dismiss").innerHTML).firstChild;y(r,"__active",!0),y(r,"__transitioning",!0),y(o,"__transitioning",!0),r.style.display="block",window.setTimeout(function(){y(r,"__transitioning",!1),y(o,"__transitioning",!1)},0),a.detailsPanel=r;var s=this;c(r.__private_overlay__=o,r.parentNode.nextSibling),o.addEventListener("click",function(){s.deactivateVenue(e)})}n&&(this.map.setCenter(a.getPosition()),this.map.setZoom(this.maxZoom))},O.prototype.deactivateVenue=function(e){this.activeVenue===e&&(this.activeVenue=null);var t=this.markerForVenue(e);if(this.unhighlightMarker(t),t.label&&(t.label.close(),t.label=null),t.detailsPanel){var n=t.detailsPanel,i=n.__private_overlay__;t.detailsPanel=null,y(n,"__transitioning",!0),i&&y(i,"__transitioning",!0),function(e,t){if(e){if(void 0===r){r=null;var n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var i in n)if(n.hasOwnProperty(i)&&void 0!==e.style[i]){r=n[i];break}}r?e.addEventListener(r,t):window.setTimeout(function(){t.call(e)},0),window.setTimeout(function(){y(e,"__active",!1)},1500)}}(n,function(){var e;y(n,"__active",!1),i&&(e=i).parentNode.removeChild(e)})}},O.prototype.highlightMarker=function(e){e.setIcon(this.pinIcons.on),e.setZIndex(this.Maps.Marker.MAX_ZINDEX+1)},O.prototype.unhighlightMarker=function(e){e.setIcon(this.pinIcons.off),e.setZIndex(1)},O.prototype.markerForVenue=function(e,t){return t&&(this.markers[e.id]=t),this.markers[e.id]},O.prototype.fitMap=function(e){if(!e||e.isEmpty())for(var t in e=new this.Maps.LatLngBounds,this.markers)this.markers.hasOwnProperty(t)&&e.extend(this.markers[t].getPosition());e.isEmpty()||(this.map.fitBounds(e),this.map.getZoom()>this.maxZoom&&this.map.setZoom(this.maxZoom))},O.prototype.buildLabel=function(e){var t=new this.Maps.InfoWindow({title:e.title,content:e.title});return this.Maps.event.addListenerOnce(t,"domready",function(){document.getElementsByClassName("gm-style-iw")[0].parentNode.className+=" map-infowindow"}),t},O.prototype.getVenuePanel=function(e){var t=e.element;if(e.image&&!e.imageLoaded){var n=g(document.getElementById("template-venue-image").innerHTML,!0).firstChild,i=h(n,["img"]);i.setAttribute("alt",e.title),i.setAttribute("src",e.image),c(n,t.firstChild),e.imageLoaded=!0}return t},O.prototype.monitorMovies=function(){var i=this,e=function(){i.moviesInteractive&&(this.isOver||(this.isOver=!0,i.activateVenue(this.__private_venue__)))},t=function(e){i.moviesInteractive&&e.target===this&&(this.isOver=!1,i.deactivateVenue(this.__private_venue__))},n=function(e){e.preventDefault();var t=this.__private_venue__,n=i.markerForVenue(t);i.Maps.event.trigger(n,"click",{manual:!0,filter:!1})};for(var a in this.moviesInteractive=!0,w)if(w.hasOwnProperty(a))for(var r=w[a],o=0;o<r.movies.length;o++){var s=r.movies[o].element;s.__private_venue__=r,s.addEventListener("mouseover",e,!0),s.addEventListener("mouseleave",t,!0);var l=h(s,[".movie__detail--venue","a"]);l.__private_venue__=r,l.addEventListener("click",n,!0)}},O.prototype.filterVenues=function(e,t){t=t||void 0===t;var n=new this.Maps.LatLngBounds;for(var i in this.markers)if(this.markers.hasOwnProperty(i)){var a=!!e[i],r=this.markers[i];r.setOpacity(a?1:.333),r.setClickable(a),a&&t&&n.extend(r.getPosition())}t&&this.fitMap(n)},window.googleMapsReady=function(){var e=document.getElementById("map"),t=window.google.maps;(P=new O(t,e,T)).show({lat:40.771133,lng:-73.974187,zoom:11});var n,i=document.getElementById("pin-images").innerHTML.split("|"),a=Math.min(1,(e.clientWidth+200)/900);P.pinIcons={off:{anchor:new t.Point(18*a,48*a),url:"data:image/svg+xml,"+encodeURIComponent(i[0]),scaledSize:new t.Size(36*a,48*a)},on:{anchor:new t.Point(26*a,60*a),url:"data:image/svg+xml,"+encodeURIComponent(i[1]),scaledSize:new t.Size(52*a,70*a)}},P.loadVenues(w),n=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].venue;i&&(t[i.id]=i)}P.filterVenues(t)},N.push(n)},window.google&&window.googleMapsReady()}();